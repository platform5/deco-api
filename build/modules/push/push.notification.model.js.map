{"version":3,"file":"push.notification.model.js","sourceRoot":"","sources":["../../../src/modules/push/push.notification.model.ts"],"names":[],"mappings":";;;;;;;;AAAA,kDAA8C;AAC9C,8BAAkF;AAClF,IAAI,KAAK,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC,iBAAiB,CAAC,CAAC;AAGhD,IAAa,qBAAqB,GAAlC,MAAa,qBAAsB,SAAQ,SAAK;IAAhD;;QAWS,iBAAY,GAAkB,EAAE,CAAC;QAIjC,mBAAc,GAAkB,EAAE,CAAC;QAInC,mBAAc,GAAkB,EAAE,CAAC;QAgCnC,eAAU,GAAkB,EAAE,CAAC;QAI/B,SAAI,GAAY,KAAK,CAAC;IAqB/B,CAAC;IAdC,MAAM,CAAC,YAA4B;QAEjC,IAAI,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,IAAI,CAAC,CAAC;QAC3C,IAAI,QAAQ,GAAG,IAAI,CAAC,cAAc,CAAC,MAAM,IAAI,CAAC,CAAC;QAC/C,IAAI,QAAQ,GAAG,IAAI,CAAC,cAAc,CAAC,MAAM,IAAI,CAAC,CAAC;QAE/C,OAAO,KAAK,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,EAAE,EAAE;YAC9C,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;YACrB,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;YACzB,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;YACzB,OAAO,IAAI,CAAC;QACd,CAAC,CAAC,CAAC;IACL,CAAC;CAEF,CAAA;AArEC;IALC,QAAI,CAAC,KAAK,CAAC,EAAC,KAAK,EAAE,oBAAQ,EAAC,CAAC;IAC7B,MAAE,CAAC,GAAG;IACN,SAAK,CAAC,UAAU,CAAC,EAAC,IAAI,EAAE,MAAM,EAAC,CAAC;IAChC,YAAQ,CAAC,QAAQ;IACjB,SAAK,CAAC,KAAK,CAAC,EAAC,IAAI,EAAE,QAAQ,EAAC,CAAC;oDACP;AAIvB;IAFC,QAAI,CAAC,KAAK,CAAC,EAAC,IAAI,EAAE,QAAQ,EAAC,CAAC;IAC5B,MAAE,CAAC,UAAU;2DAC0B;AAIxC;IAFC,QAAI,CAAC,KAAK,CAAC,EAAC,IAAI,EAAE,QAAQ,EAAC,CAAC;IAC5B,MAAE,CAAC,UAAU;6DAC4B;AAI1C;IAFC,QAAI,CAAC,KAAK,CAAC,EAAC,IAAI,EAAE,QAAQ,EAAC,CAAC;IAC5B,MAAE,CAAC,UAAU;6DAC4B;AAI1C;IAFC,QAAI,CAAC,MAAM;IACX,MAAE,CAAC,GAAG;oDACc;AAIrB;IAFC,QAAI,CAAC,MAAM;IACX,MAAE,CAAC,GAAG;sDACgB;AAIvB;IAFC,QAAI,CAAC,MAAM;IACX,MAAE,CAAC,GAAG;0DACoB;AAI3B;IAFC,QAAI,CAAC,OAAO;IACZ,MAAE,CAAC,GAAG;+DACwB;AAI/B;IAFC,QAAI,CAAC,OAAO;IACZ,MAAE,CAAC,GAAG;oDACa;AAIpB;IAFC,QAAI,CAAC,MAAM;IACX,MAAE,CAAC,GAAG;qDACe;AAItB;IAFC,QAAI,CAAC,IAAI;IACT,MAAE,CAAC,GAAG;qDACa;AAIpB;IAFC,QAAI,CAAC,KAAK,CAAC,EAAC,IAAI,EAAE,QAAQ,EAAC,CAAC;IAC5B,MAAE,CAAC,GAAG;yDAC+B;AAItC;IAFC,QAAI,CAAC,OAAO;IACZ,MAAE,CAAC,UAAU;mDACe;AAK7B;IAHC,QAAI,CAAC,IAAI;IACT,MAAE,CAAC,UAAU;IACb,MAAE,CAAC,MAAM;qDACU;AA5DT,qBAAqB;IADjC,SAAK,CAAC,kBAAkB,CAAC;GACb,qBAAqB,CA4EjC;AA5EY,sDAAqB","sourcesContent":["import { AppModel } from './../app/app.model';\nimport { model, Model, type, io, query, validate, ObjectId, mongo } from '../../';\nlet debug = require('debug')('app:models:dico');\n\n@model('pushnotification')\nexport class PushNotificationModel extends Model {\n\n  @type.model({model: AppModel})\n  @io.all\n  @query.filterable({type: 'auto'})\n  @validate.required\n  @mongo.index({type: 'single'})\n  public appId: ObjectId;\n\n  @type.array({type: 'string'})\n  @io.toDocument\n  public sentToRegIds: Array<string> = [];\n\n  @type.array({type: 'string'})\n  @io.toDocument\n  public viewedByRegIds: Array<string> = [];\n\n  @type.array({type: 'string'})\n  @io.toDocument\n  public openedByRegIds: Array<string> = [];\n\n  @type.string\n  @io.all\n  public title: string;\n\n  @type.string\n  @io.all\n  public message: string;\n\n  @type.string\n  @io.all\n  public collapseKey: string;\n\n  @type.boolean\n  @io.all\n  public contentAvailable: false;\n\n  @type.integer\n  @io.all\n  public badge: false;\n\n  @type.string\n  @io.all\n  public custom: string;\n\n  @type.date\n  @io.all\n  public sendAt: Date;\n\n  @type.array({type: 'string'})\n  @io.all\n  public sendToTags: Array<string> = [];\n\n  @type.boolean\n  @io.toDocument\n  public sent: boolean = false;\n\n  @type.date\n  @io.toDocument\n  @io.output\n  public sentAt: Date;\n\n  output(includeProps?: Array<string>): Promise<any> {\n\n    let nbSent = this.sentToRegIds.length || 0;\n    let nbViewed = this.viewedByRegIds.length || 0;\n    let nbOpened = this.openedByRegIds.length || 0;\n\n    return super.output(includeProps).then((data) => {\n      data.nbSent = nbSent;\n      data.nbViewed = nbViewed;\n      data.nbOpened = nbOpened;\n      return data;\n    });\n  }\n  \n}"]}